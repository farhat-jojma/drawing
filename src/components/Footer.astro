---
import { getLangStaticPaths, resolveLang } from "../lib/i18n";

export async function getStaticPaths() {
  return getLangStaticPaths();
}

const locale = resolveLang(Astro.params.lang);
const dict = await import(`../locales/${locale}.json`).then((m) => m.default);
---

<footer class="w-full mt-16 bg-gradient-to-t from-gray-100 to-white border-t-2 border-black" lang={locale}>
  <div class="pixel-divider"></div>
  <div class="w-full px-6 md:px-10 py-10">
    <div class="grid md:grid-cols-3 gap-8">
      <div>
        <div class="inline-flex items-center gap-2 px-3 py-1 mb-3 bg-white border-2 border-black shadow-[4px_4px_0_#000] whitespace-nowrap">
          <img class="logo-img" src="/favicon.png" alt={dict.siteName} width="28" height="28" />
          <span class="text-xs tracking-widest uppercase">Pixel Drawing</span>
        </div>
        <p class="text-gray-700">{dict.footerSubtitle}</p>
      </div>

      <nav>
        <h3 class="font-bold mb-3">{dict.footerExplore}</h3>
        <ul class="space-y-2">
          <li><a href={`/${locale}/`} class="underline hover:no-underline">{dict.footerPlay}</a></li>
          <li>
            <button
              type="button"
              onclick={`event.preventDefault(); goToSection('how-to-play','${locale}');`}
              class="underline hover:no-underline"
            >
              {dict.footerHowToPlay}
            </button>
          </li>
          
          <li>
            <button
              type="button"
              onclick={`event.preventDefault(); goToSection('tips','${locale}');`}
              class="underline hover:no-underline"
            >
              {dict.footerTips}
            </button>
          </li>
          
          
        </ul>
      </nav>

      <nav>
        <h3 class="font-bold mb-3">{dict.footerLegal}</h3>
        <ul class="space-y-2">
          <li><a href={`/${locale}/about`} class="underline hover:no-underline">{dict.footerAbout}</a></li>
          <li><a href={`/${locale}/privacy-policy`} class="underline hover:no-underline">{dict.footerPrivacy}</a></li>
          <li><a href={`/${locale}/terms-of-service`} class="underline hover:no-underline">{dict.footerTerms}</a></li>
        </ul>
      </nav>
    </div>

    <div class="mt-10 flex items-center justify-between border-t border-black/20 pt-6 text-sm text-gray-600">
      <p>© {new Date().getFullYear()} Pixel Drawing Online</p>
      <div class="flex items-center gap-3">
        <span class="pixel-icon blue" title="Social"></span>
        <span class="pixel-icon green" title="Social"></span>
      </div>
    </div>
  </div>
  <script is:inline>
    function goToSection(sectionId, locale) {
      const isHome = window.location.pathname === `/${locale}/`;
  
      if (isHome) {
        // Déjà sur la home → scroll direct
        const el = document.getElementById(sectionId);
        if (el) {
          el.scrollIntoView({ behavior: "smooth" });
        }
      } else {
        // Pas sur la home → stocke l’info et redirige
        localStorage.setItem("scrollTo", sectionId);
        window.location.href = `/${locale}/`;
      }
    }
  </script>
  
</footer>

